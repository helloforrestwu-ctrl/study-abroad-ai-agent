"""
Visa Advisor Agent - ç­¾è¯ææ–™ä¸é¢ç­¾è¾…å¯¼
æä¾›ç­¾è¯ææ–™æ¸…å•ã€é¢ç­¾å¸¸è§é—®é¢˜æ”»ç•¥
"""


class VisaAdvisor:
    """ç­¾è¯è¾…å¯¼Agent"""

    def __init__(self):
        self.visa_requirements = {
            "ç¾å›½": {
                "ç­¾è¯ç±»å‹": "F-1å­¦ç”Ÿç­¾è¯",
                "æ‰€éœ€æ–‡ä»¶": [
                    "æœ‰æ•ˆæŠ¤ç…§(æœ‰æ•ˆæœŸâ‰¥6ä¸ªæœˆ)",
                    "I-20è¡¨æ ¼(å­¦æ ¡å‘æ”¾)",
                    "DS-160ç¡®è®¤é¡µ",
                    "SEVISè´¹æ”¶æ®",
                    "ç­¾è¯ç…§ç‰‡(51mmÃ—51mm)",
                    "å½•å–é€šçŸ¥ä¹¦",
                    "è¯­è¨€æˆç»©å•",
                    "èµ„é‡‘è¯æ˜(è¦†ç›–ç¬¬ä¸€å¹´å­¦è´¹+ç”Ÿæ´»è´¹)",
                    "å­˜æ¬¾è¯æ˜/é“¶è¡Œæµæ°´",
                    "çˆ¶æ¯å·¥ä½œæ”¶å…¥è¯æ˜",
                    "å­¦ä¹ è®¡åˆ’",
                    "æˆç»©å•/å­¦ä½è¯"
                ],
                "èµ„é‡‘è¦æ±‚": "å»ºè®®å‡†å¤‡ç¬¬ä¸€å¹´æ€»è´¹ç”¨çš„1.5å€(çº¦60-100ä¸‡äººæ°‘å¸)",
                "é¢ç­¾å¸¸è§é—®é¢˜": [
                    "Why do you want to study in the US?",
                    "Why this university/program?",
                    "What will you do after graduation?",
                    "Who will sponsor your study?",
                    "Do you have relatives in the US?",
                    "Have you been to the US before?"
                ],
                "æ‹’ç­¾åŸå› ": [
                    "ç§»æ°‘å€¾å‘(æœªèƒ½è¯æ˜å­¦æˆå›å›½çš„æ„æ„¿)",
                    "èµ„é‡‘è¯æ˜ä¸è¶³æˆ–æ¥æºä¸æ˜",
                    "å­¦ä¹ è®¡åˆ’ä¸åˆç†(å¦‚ä¸“ä¸šè·¨åº¦è¿‡å¤§)",
                    "è¯­è¨€èƒ½åŠ›ä¸è¶³ï¼Œæ— æ³•ç”¨è‹±è¯­äº¤æµ",
                    "ææ–™é€ å‡æˆ–ä¿¡æ¯ä¸ä¸€è‡´"
                ]
            },
            "è‹±å›½": {
                "ç­¾è¯ç±»å‹": "Tier 4å­¦ç”Ÿç­¾è¯(ç°ç§°Student Visa)",
                "æ‰€éœ€æ–‡ä»¶": [
                    "æœ‰æ•ˆæŠ¤ç…§",
                    "CAS (Confirmation of Acceptance for Studies)",
                    "è‚ºç»“æ ¸æ£€æµ‹è¯æ˜",
                    "èµ„é‡‘è¯æ˜(å­˜æ»¡28å¤©)",
                    "è¯­è¨€æˆç»©å•",
                    "å­¦ä½è¯/æˆç»©å•",
                    "ç­¾è¯ç”³è¯·è¡¨",
                    "ç”Ÿç‰©è¯†åˆ«é¢„çº¦ç¡®è®¤"
                ],
                "èµ„é‡‘è¦æ±‚": "å­¦è´¹å…¨é¢ + ç”Ÿæ´»è´¹(ä¼¦æ•¦åœ°åŒºÂ£1,334/æœˆÃ—9ä¸ªæœˆï¼Œéä¼¦æ•¦Â£1,023/æœˆ)",
                "é¢ç­¾å¸¸è§é—®é¢˜": [
                    "è‹±å›½ç­¾è¯ä¸€èˆ¬æ— éœ€é¢ç­¾ï¼Œä½†å¯èƒ½ç”µè¯è°ƒæŸ¥",
                    "å‡†å¤‡å¥½è§£é‡Šå­¦ä¹ è®¡åˆ’å’Œèµ„é‡‘æ¥æº"
                ],
                "æ‹’ç­¾åŸå› ": [
                    "CASä¿¡æ¯æœ‰è¯¯",
                    "èµ„é‡‘è¯æ˜ä¸ç¬¦åˆè¦æ±‚(æœªå­˜æ»¡28å¤©)",
                    "è‚ºç»“æ ¸æ£€æµ‹è¿‡æœŸæˆ–ä¸åˆæ ¼",
                    "è™šå‡ææ–™"
                ]
            },
            "åŠ æ‹¿å¤§": {
                "ç­¾è¯ç±»å‹": "Study Permitå­¦ä¹ è®¸å¯",
                "æ‰€éœ€æ–‡ä»¶": [
                    "æœ‰æ•ˆæŠ¤ç…§",
                    "å½•å–é€šçŸ¥ä¹¦",
                    "èµ„é‡‘è¯æ˜(GICæŠ•èµ„è¯æ˜æˆ–å­˜æ¬¾è¯æ˜)",
                    "ä½“æ£€æŠ¥å‘Š",
                    "æ— çŠ¯ç½ªè®°å½•è¯æ˜",
                    "å­¦ä¹ è®¡åˆ’(Study Plan)",
                    "è¯­è¨€æˆç»©",
                    "ç­¾è¯ç…§ç‰‡"
                ],
                "èµ„é‡‘è¦æ±‚": "ç¬¬ä¸€å¹´å­¦è´¹ + ç”Ÿæ´»è´¹CAD$10,000+",
                "é¢ç­¾å¸¸è§é—®é¢˜": [
                    "åŠ æ‹¿å¤§ç­¾è¯ä¸»è¦ä¸ºææ–™å®¡æ ¸ï¼Œéƒ¨åˆ†ç”³è¯·äººå¯èƒ½è¢«è¦æ±‚é¢ç­¾",
                    "é‡ç‚¹å‡†å¤‡å­¦ä¹ è®¡åˆ’ä¹¦(Study Plan)"
                ],
                "æ‹’ç­¾åŸå› ": [
                    "å­¦ä¹ ç›®çš„ä¸æ˜ç¡®",
                    "èµ„é‡‘æ¥æºä¸æ¸…æ™°",
                    "å›½å†…çº¦æŸåŠ›ä¸è¶³",
                    "å­¦ä¹ è®¡åˆ’ä¸åˆç†"
                ]
            },
            "æ¾³å¤§åˆ©äºš": {
                "ç­¾è¯ç±»å‹": "500å­¦ç”Ÿç­¾è¯",
                "æ‰€éœ€æ–‡ä»¶": [
                    "æœ‰æ•ˆæŠ¤ç…§",
                    "COE (Confirmation of Enrollment)",
                    "GTE (Genuine Temporary Entrant)å£°æ˜",
                    "OSHCæµ·å¤–å­¦ç”Ÿå¥åº·ä¿é™©",
                    "èµ„é‡‘è¯æ˜",
                    "è¯­è¨€æˆç»©",
                    "å­¦å†è¯æ˜"
                ],
                "èµ„é‡‘è¦æ±‚": "ç¬¬ä¸€å¹´å­¦è´¹ + ç”Ÿæ´»è´¹AUD$21,041/å¹´",
                "é¢ç­¾å¸¸è§é—®é¢˜": [
                    "æ¾³æ´²ç­¾è¯ä¸€èˆ¬æ— éœ€é¢ç­¾",
                    "GTEå£°æ˜éœ€é˜æ˜çœŸå®å­¦ä¹ æ„å›¾"
                ],
                "æ‹’ç­¾åŸå› ": [
                    "GTEå£°æ˜ä¸å……åˆ†",
                    "èµ„é‡‘è¯æ˜ä¸è¶³",
                    "ææ–™ä¸å…¨æˆ–ä¸å®"
                ]
            },
            "é¦™æ¸¯": {
                "ç­¾è¯ç±»å‹": "å­¦ç”Ÿç­¾è¯(éæœ¬åœ°å­¦ç”Ÿ)",
                "æ‰€éœ€æ–‡ä»¶": [
                    "æœ‰æ•ˆæŠ¤ç…§/é€šè¡Œè¯",
                    "å½•å–é€šçŸ¥ä¹¦",
                    "ID995Aç”³è¯·è¡¨",
                    "è¿‘ç…§",
                    "èµ„é‡‘è¯æ˜",
                    "å­¦å†è¯æ˜"
                ],
                "èµ„é‡‘è¦æ±‚": "å»ºè®®å‡†å¤‡15-20ä¸‡æ¸¯å¸/å¹´",
                "é¢ç­¾å¸¸è§é—®é¢˜": [
                    "é¦™æ¸¯å­¦ç”Ÿç­¾è¯æ— éœ€é¢ç­¾",
                    "å®¡æ‰¹å‘¨æœŸçº¦6-8å‘¨"
                ],
                "æ‹’ç­¾åŸå› ": [
                    "ææ–™ä¸å…¨",
                    "èµ„é‡‘è¯æ˜ä¸è¶³",
                    "å­¦å†ä¸ç¬¦åˆè¦æ±‚"
                ]
            },
            "æ–°åŠ å¡": {
                "ç­¾è¯ç±»å‹": "Student's Pass",
                "æ‰€éœ€æ–‡ä»¶": [
                    "æœ‰æ•ˆæŠ¤ç…§",
                    "å½•å–é€šçŸ¥ä¹¦",
                    "Form 16 (å­¦æ ¡æä¾›)",
                    "å­˜æ¬¾è¯æ˜(16ä¸‡äººæ°‘å¸ä»¥ä¸Š)",
                    "å‡ºç”Ÿè¯æ˜å…¬è¯",
                    "çˆ¶æ¯å·¥ä½œè¯æ˜",
                    "å­¦å†å…¬è¯"
                ],
                "èµ„é‡‘è¦æ±‚": "çº¦16-20ä¸‡äººæ°‘å¸",
                "é¢ç­¾å¸¸è§é—®é¢˜": [
                    "æ–°åŠ å¡å­¦ç”Ÿç­¾è¯ä¸€èˆ¬æ— éœ€é¢ç­¾",
                    "éƒ¨åˆ†å­¦æ ¡å¯èƒ½è¦æ±‚è§†é¢‘é¢è¯•"
                ],
                "æ‹’ç­¾åŸå› ": [
                    "ææ–™é€ å‡",
                    "èµ„é‡‘ä¸è¶³",
                    "å­¦å†ä¸ç¬¦"
                ]
            }
        }

    def provide_visa_guide(self, target_countries):
        """
        æä¾›ç­¾è¯æŒ‡å—
        :param target_countries: ç›®æ ‡å›½å®¶åˆ—è¡¨
        :return: ç­¾è¯æ”»ç•¥æ–‡æœ¬
        """
        print("ğŸ›‚ VisaAdvisor Agent å¼€å§‹ç”Ÿæˆç­¾è¯æ”»ç•¥...")

        output = []
        output.append("\n" + "="*80)
        output.append("ğŸ›‚ ç­¾è¯ææ–™æ¸…å•ä¸é¢ç­¾æ”»ç•¥ | Visa Application Guide")
        output.append("="*80 + "\n")

        for country in target_countries:
            if country not in self.visa_requirements:
                continue

            visa_info = self.visa_requirements[country]

            output.append(f"## {country}ç­¾è¯æ”»ç•¥\n")
            output.append(f"**ç­¾è¯ç±»å‹:** {visa_info['ç­¾è¯ç±»å‹']}\n")

            # ææ–™æ¸…å•
            output.append("**ğŸ“‹ æ‰€éœ€ææ–™æ¸…å•:**\n")
            for i, doc in enumerate(visa_info['æ‰€éœ€æ–‡ä»¶'], 1):
                output.append(f"  {i}. {doc}")
            output.append("")

            # èµ„é‡‘è¦æ±‚
            output.append(f"**ğŸ’° èµ„é‡‘è¯æ˜è¦æ±‚:**")
            output.append(f"  {visa_info['èµ„é‡‘è¦æ±‚']}\n")

            # é¢ç­¾é—®é¢˜
            if visa_info['é¢ç­¾å¸¸è§é—®é¢˜']:
                output.append("**ğŸ¤ é¢ç­¾å¸¸è§é—®é¢˜:**\n")
                for question in visa_info['é¢ç­¾å¸¸è§é—®é¢˜']:
                    output.append(f"  â€¢ {question}")
                output.append("")

            # æ‹’ç­¾åŸå› 
            output.append("**âš ï¸  é«˜é¢‘æ‹’ç­¾åŸå› åŠåº”å¯¹ç­–ç•¥:**\n")
            for i, reason in enumerate(visa_info['æ‹’ç­¾åŸå› '], 1):
                output.append(f"  {i}. {reason}")

                # é’ˆå¯¹æ€§å»ºè®®
                if "ç§»æ°‘å€¾å‘" in reason:
                    output.append("     â†’ åº”å¯¹: å‡†å¤‡å›½å†…çº¦æŸåŠ›è¯æ˜(å®¶åº­ã€å·¥ä½œã€è´¢äº§)")
                elif "èµ„é‡‘" in reason:
                    output.append("     â†’ åº”å¯¹: æä¾›å……è¶³ä¸”æ¥æºæ¸…æ™°çš„èµ„é‡‘è¯æ˜ï¼Œé“¶è¡Œæµæ°´éœ€è¦†ç›–6ä¸ªæœˆ")
                elif "å­¦ä¹ è®¡åˆ’" in reason:
                    output.append("     â†’ åº”å¯¹: é˜æ˜ä¸“ä¸šé€‰æ‹©åˆç†æ€§ï¼Œä¸èŒä¸šç›®æ ‡çš„å…³è”")
                elif "è¯­è¨€" in reason:
                    output.append("     â†’ åº”å¯¹: æå‡è‹±è¯­æ°´å¹³ï¼Œé¢ç­¾æ—¶è‡ªä¿¡æµåˆ©å›ç­”")
                elif "ææ–™" in reason or "é€ å‡" in reason:
                    output.append("     â†’ åº”å¯¹: ç¡®ä¿æ‰€æœ‰ææ–™çœŸå®å‡†ç¡®ï¼Œä¿¡æ¯ä¸€è‡´")

            output.append("\n" + "-"*80 + "\n")

        # é€šç”¨å»ºè®®
        output.append("="*80)
        output.append("ã€ç­¾è¯ç”³è¯·é€šç”¨å»ºè®®ã€‘")
        output.append("="*80 + "\n")

        output.append("**1. æ—¶é—´è§„åˆ’:**")
        output.append("  - è·å¾—I-20/CASåç«‹å³é¢„çº¦ç­¾è¯(æ—ºå­£5-7æœˆéœ€æå‰)")
        output.append("  - é¢„ç•™è‡³å°‘1ä¸ªæœˆæ—¶é—´å‡†å¤‡ææ–™")
        output.append("  - ä¸‡ä¸€è¢«æ‹’ç­¾ï¼Œé¢„ç•™äºŒç­¾æ—¶é—´\n")

        output.append("**2. èµ„é‡‘è¯æ˜å…³é”®ç‚¹:**")
        output.append("  - å­˜æ¬¾è¯æ˜éœ€å†»ç»“è‡³å¼€å­¦å")
        output.append("  - é“¶è¡Œæµæ°´ä½“ç°ç¨³å®šæ”¶å…¥æ¥æº")
        output.append("  - é¿å…çªç„¶å¤§é¢å­˜æ¬¾(å¼•èµ·æ€€ç–‘)")
        output.append("  - å¦‚æœ‰å¥–å­¦é‡‘ï¼Œæä¾›å¥–å­¦é‡‘è¯æ˜å¯é™ä½èµ„é‡‘è¦æ±‚\n")

        output.append("**3. å­¦ä¹ è®¡åˆ’æ’°å†™è¦ç‚¹:**")
        output.append("  - ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªä¸“ä¸š?(ç»“åˆè¿‡å¾€ç»å†)")
        output.append("  - ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªå›½å®¶/å­¦æ ¡?(å…·ä½“é¡¹ç›®ä¼˜åŠ¿)")
        output.append("  - å­¦æˆåçš„èŒä¸šè§„åˆ’(æœ€å¥½ä¸å›½å†…å‘å±•ç›¸å…³)")
        output.append("  - é•¿åº¦æ§åˆ¶åœ¨800-1000å­—\n")

        output.append("**4. é¢ç­¾æŠ€å·§(é€‚ç”¨äºç¾å›½ç­‰éœ€é¢ç­¾å›½å®¶):**")
        output.append("  - è‡ªä¿¡ã€è¯šå®ã€ç®€æ´å›ç­”")
        output.append("  - çœ¼ç¥äº¤æµï¼Œä¿æŒå¾®ç¬‘")
        output.append("  - ä¸è¦èƒŒç¨¿ï¼Œè‡ªç„¶äº¤æµ")
        output.append("  - å‡†å¤‡ä¸­è‹±æ–‡å›ç­”")
        output.append("  - ææ–™æ•´ç†æœ‰åºï¼Œé¢è¯•å®˜è¦æ±‚æ—¶å¿«é€Ÿæä¾›\n")

        output.append("**5. å¸¸è§è¯¯åŒº:**")
        output.append("  âŒ è¯¯åŒº1: å­˜æ¬¾è¶Šå¤šè¶Šå¥½ â†’ åˆç†å³å¯ï¼Œé‡ç‚¹æ˜¯æ¥æºæ¸…æ™°")
        output.append("  âŒ è¯¯åŒº2: æœ‰äº²æˆšåœ¨å›½å¤–ä¸€å®šæ‹’ç­¾ â†’ å¦‚å®å›ç­”ï¼Œå¼ºè°ƒå­¦ä¹ ç›®çš„")
        output.append("  âŒ è¯¯åŒº3: ææ–™è¶Šå¤šè¶Šå¥½ â†’ ç²¾ç®€æœ‰æ•ˆï¼Œé¿å…æ— å…³ææ–™")

        output.append("\n" + "="*80 + "\n")

        print("âœ… ç­¾è¯æ”»ç•¥ç”Ÿæˆå®Œæˆ")

        return "\n".join(output)
